import numpy as np
from sklearn.metrics import confusion_matrix

def output_metrix_from_matrix(y_test, y_pred, labels_num: int = 11):
    matrix = confusion_matrix(y_test, y_pred)
    TP = []
    FP = []
    TN = []
    FN = []

    for k in range(labels_num):
        fp = 0
        fn = 0
        tn = 0
        for i in range(labels_num):
            for j in range(labels_num):
                if k == i and k == j:
                    TP.append(matrix[i][j])
                elif k == i and k != j:
                    fp += matrix[i][j]
                elif k != i and k == j:
                    fn += matrix[i][j]
                else:
                    tn += matrix[i][j]
        FP.append(fp)
        FN.append(fn)
        TN.append(tn)

    TPs = sum(TP)
    accuracy = TPs / sum(list(map(sum, zip(*matrix))))

    precision = list()
    for i in range(labels_num):
        if TP[i]:
            precision.append(TP[i] / (TP[i] + FP[i]))
        else:
            precision.append(0)

    recall = list()
    for i in range(labels_num):
        if TP[i]:
            recall.append(TP[i] / (TP[i] + FN[i]))
        else:
            recall.append(0)

    f1_score = list()
    for i in range(labels_num):
        if precision[i] != 0 and recall[i] != 0:
            f1_score.append((2 * precision[i] * recall[i]) / (precision[i] + recall[i]))
        else:
            f1_score.append(0)

    fpr = list()
    for i in range(labels_num):
      fpr.append(FP[i] / (FP[i] + TN[i]))

    for i in range(labels_num):
        print('Pr: {:.4f}'.format(precision[i]), end="\t")
        print('Re: {:.4f}'.format(recall[i]), end="\t")
        print('F1: {:.4f}'.format(f1_score[i]), end="\t")
        print('FPR: {:.4f}'.format(fpr[i]), end="\n")
    print()
    print('Accuracy: {:.4f}'.format(accuracy))
    print('Precision: {:.4f}'.format(np.nansum(precision) / labels_num))
    print('Recall: {:.4f}'.format(np.nansum(recall) / labels_num))
    print('F1-Score: {:.4f}'.format(np.nansum(f1_score) / labels_num))
    print('FPR: {:.4f}'.format(np.nansum(fpr) / labels_num))
    print(matrix)
