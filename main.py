from model.category import PlainModel
from module.dataset import DumpwarePreparation
from module.metrix import output_metrix_from_matrix
from module.schema import LabelsNum, PretrainedModel, ClassifyModel

input_labels_num = 11
input_pretraind_model = "vgg16"
input_classify_model = "fcn"

labels_num = LabelsNum(input_labels_num)
pretraind_model = PretrainedModel(input_pretraind_model)
classify_model = ClassifyModel(input_classify_model)


"""
Dataset
"""
dataset = DumpwarePreparation(
    # data_dir=,
    labels_num=labels_num.value,
    model_name=pretraind_model.value
)
x_train, x_test, y_train, y_test = dataset.prepare_dumpware10_for_category()
dataset.summary()

"""
Model
"""
model = PlainModel(
    x_train=x_train,
    y_train=y_train,
    x_test=x_test,
    convolutional_model=pretraind_model.value,
    classify_func=classify_model.value
)
raise Exception("A"*30)
y_pred = model()
output_metrix_from_matrix(y_test=y_test, y_pred=y_pred, labels_num=11)
