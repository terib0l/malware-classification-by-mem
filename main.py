import argparse
from model.category import PlainModel
from module.dataset import DumpwarePreparation
from module.metrix import output_metrix_from_matrix
from module.schema import LabelsNum, PretrainedModel, ClassifyModel

# parser = argparse.ArgumentParser()
# parser.add_argument()

input_labels_num = 11
input_pretraind_model = "vgg16"
input_classify_model = "fcn"

labels_num = LabelsNum(input_labels_num)
pretraind_model = PretrainedModel(input_pretraind_model)
classify_model = ClassifyModel(input_classify_model)


dataset = DumpwarePreparation(
    # data_dir=[
    #     '/content/4096/300/TRAIN/',
    #     '/content/4096/300/TEST/'
    # ],
    labels_num=labels_num.value,
    model_name=pretraind_model.value
)
x_train, x_test, y_train, y_test = dataset.prepare_dumpware10_for_category()
dataset.summary()

model = PlainModel(
    x_train=x_train,
    y_train=y_train,
    x_test=x_test,
    convolutional_model=pretraind_model.value,
    classify_func=classify_model.value
)
y_pred = model.flow_execute()
print(y_pred.shape)
raise Exception("B"*40)
output_metrix_from_matrix(y_test=y_test, y_pred=y_pred, labels_num=11)
